<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="872px" preserveAspectRatio="none" style="width:1022px;height:872px;" version="1.1" viewBox="0 0 1022 872" width="1022px" zoomAndPan="magnify"><defs><filter height="300%" id="fn5y45fmrgmxv" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="271" x="373.75" y="30.6855">Message Queuing Implementation</text><rect fill="#DDDDDD" height="823.7266" style="stroke:#A80036;stroke-width:1.0;" width="192" x="292" y="42.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="166" x="303" y="56.1357">[serialized on the sender's</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="310.5" y="72.4873">device, but not visible to</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="186" x="295" y="88.8389">the application after sending]</text><rect fill="#DDDDDD" height="823.7266" style="stroke:#A80036;stroke-width:1.0;" width="158" x="674.5" y="42.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="677.5" y="56.1357">[running in background]</text><rect fill="#FFFFFF" filter="url(#fn5y45fmrgmxv)" height="86.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="383" y="272.2266"/><rect fill="#FFFFFF" filter="url(#fn5y45fmrgmxv)" height="86.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="383" y="546.2969"/><rect fill="#FFFFFF" filter="url(#fn5y45fmrgmxv)" height="233.7188" style="stroke:#A80036;stroke-width:1.0;" width="10" x="958" y="459.3359"/><rect fill="#FFFFFF" filter="url(#fn5y45fmrgmxv)" height="169.0156" style="stroke:#000000;stroke-width:2.0;" width="528.5" x="480" y="317.5781"/><rect fill="#FFFFFF" filter="url(#fn5y45fmrgmxv)" height="109.4063" style="stroke:#000000;stroke-width:2.0;" width="528.5" x="480" y="591.6484"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="22" x2="22" y1="162.9141" y2="778.7578"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="138.5" x2="138.5" y1="162.9141" y2="778.7578"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="387.5" x2="387.5" y1="162.9141" y2="778.7578"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="556" x2="556" y1="162.9141" y2="778.7578"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="753.5" x2="753.5" y1="206.2188" y2="778.7578"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="877.5" x2="877.5" y1="162.9141" y2="778.7578"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="962.5" x2="962.5" y1="466.7891" y2="778.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="5" y="159.8379">User</text><ellipse cx="22.5" cy="88.3047" fill="#FEFECE" filter="url(#fn5y45fmrgmxv)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M22.5,96.3047 L22.5,123.3047 M9.5,104.3047 L35.5,104.3047 M22.5,123.3047 L9.5,138.3047 M22.5,123.3047 L35.5,138.3047 " fill="none" filter="url(#fn5y45fmrgmxv)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="5" y="792.291">User</text><ellipse cx="22.5" cy="805.3672" fill="#FEFECE" filter="url(#fn5y45fmrgmxv)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M22.5,813.3672 L22.5,840.3672 M9.5,821.3672 L35.5,821.3672 M22.5,840.3672 L9.5,855.3672 M22.5,840.3672 L35.5,855.3672 " fill="none" filter="url(#fn5y45fmrgmxv)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="85.5" y="159.8379">Tagging UI/iPad</text><path d="M118,117.3047 L118,141.3047 M118,129.3047 L135,129.3047 " fill="none" filter="url(#fn5y45fmrgmxv)" style="stroke:#A80036;stroke-width:2.0;"/><ellipse cx="147" cy="129.3047" fill="#FEFECE" filter="url(#fn5y45fmrgmxv)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="85.5" y="792.291">Tagging UI/iPad</text><path d="M118,799.3672 L118,823.3672 M118,811.3672 L135,811.3672 " fill="none" filter="url(#fn5y45fmrgmxv)" style="stroke:#A80036;stroke-width:2.0;"/><ellipse cx="147" cy="811.3672" fill="#FEFECE" filter="url(#fn5y45fmrgmxv)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="333" y="142.2285">Message Queue</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="329.5" y="159.8379">(ZMQ, RabbitMQ)</text><ellipse cx="388" cy="111.6953" fill="#FEFECE" filter="url(#fn5y45fmrgmxv)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="376" x2="400" y1="125.6953" y2="125.6953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="333" y="792.291">Message Queue</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="329.5" y="809.9004">(ZMQ, RabbitMQ)</text><ellipse cx="388" cy="828.9766" fill="#FEFECE" filter="url(#fn5y45fmrgmxv)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="376" x2="400" y1="842.9766" y2="842.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="490" y="142.2285">Streaming/Encoding</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="530" y="159.8379">Service</text><ellipse cx="556.5" cy="111.6953" fill="#FEFECE" filter="url(#fn5y45fmrgmxv)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="552.5,99.6953,558.5,94.6953,556.5,99.6953,558.5,104.6953,552.5,99.6953" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="490" y="792.291">Streaming/Encoding</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="530" y="809.9004">Service</text><ellipse cx="556.5" cy="828.9766" fill="#FEFECE" filter="url(#fn5y45fmrgmxv)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="552.5,816.9766,558.5,811.9766,556.5,816.9766,558.5,821.9766,552.5,816.9766" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#fn5y45fmrgmxv)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="82" x="710.5" y="777.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="68" x="717.5" y="799.291">Dispatcher</text><rect fill="#FEFECE" filter="url(#fn5y45fmrgmxv)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="71" x="842.5" y="122.3047"/><rect fill="#FEFECE" filter="url(#fn5y45fmrgmxv)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="71" x="838.5" y="126.3047"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="845.5" y="147.8379">Cameras</text><rect fill="#FEFECE" filter="url(#fn5y45fmrgmxv)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="71" x="842.5" y="777.7578"/><rect fill="#FEFECE" filter="url(#fn5y45fmrgmxv)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="71" x="838.5" y="781.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="845.5" y="803.291">Cameras</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="927.5" y="792.291">Media File</text><ellipse cx="963" cy="811.3672" fill="#FEFECE" filter="url(#fn5y45fmrgmxv)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="951" x2="975" y1="825.3672" y2="825.3672"/><rect fill="#FFFFFF" filter="url(#fn5y45fmrgmxv)" height="86.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="383" y="272.2266"/><rect fill="#FFFFFF" filter="url(#fn5y45fmrgmxv)" height="86.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="383" y="546.2969"/><rect fill="#FFFFFF" filter="url(#fn5y45fmrgmxv)" height="233.7188" style="stroke:#A80036;stroke-width:1.0;" width="10" x="958" y="459.3359"/><polygon fill="#A80036" points="698.5,191.2656,708.5,195.2656,698.5,199.2656,702.5,195.2656" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="556.5" x2="704.5" y1="195.2656" y2="195.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="34" x="563.5" y="190.4092">start()</text><rect fill="#FEFECE" filter="url(#fn5y45fmrgmxv)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="82" x="710.5" y="172.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="68" x="717.5" y="194.4473">Dispatcher</text><polygon fill="#A80036" points="126.5,237.875,136.5,241.875,126.5,245.875,130.5,241.875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="22.5" x2="132.5" y1="241.875" y2="241.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="29.5" y="237.0186">startRecording()</text><polygon fill="#A80036" points="371,268.2266,381,272.2266,371,276.2266,375,272.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="138.5" x2="377" y1="272.2266" y2="272.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="145.5" y="267.3701">enque(startRecording)</text><polygon fill="#A80036" points="404,298.5781,394,302.5781,404,306.5781,400,302.5781" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="398" x2="752.5" y1="302.5781" y2="302.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="410" y="297.7217">deque(startRecording)</text><path d="M480,317.5781 L546,317.5781 L546,325.5781 L536,335.5781 L480,335.5781 L480,317.5781 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="169.0156" style="stroke:#000000;stroke-width:2.0;" width="528.5" x="480" y="317.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="495" y="332.0732">par</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="561" y="330.9971">[thread#1]</text><polygon fill="#A80036" points="567.5,354.2813,557.5,358.2813,567.5,362.2813,563.5,358.2813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="561.5" x2="752.5" y1="358.2813" y2="358.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="573.5" y="353.4248">dispatch(startRecording)</text><polygon fill="#A80036" points="866,384.6328,876,388.6328,866,392.6328,870,388.6328" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="556.5" x2="872" y1="388.6328" y2="388.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="563.5" y="383.7764">openStream()</text><polygon fill="#A80036" points="567.5,414.9844,557.5,418.9844,567.5,422.9844,563.5,418.9844" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="561.5" x2="877" y1="418.9844" y2="418.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="573.5" y="414.1279">return(stream)</text><polygon fill="#A80036" points="915.5,445.3359,925.5,449.3359,915.5,453.3359,919.5,449.3359" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="556.5" x2="921.5" y1="449.3359" y2="449.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="563.5" y="444.4795">encode()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="927.5" y="473.5176">Media File</text><ellipse cx="963" cy="442.9844" fill="#FEFECE" filter="url(#fn5y45fmrgmxv)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="951" x2="975" y1="456.9844" y2="456.9844"/><polygon fill="#A80036" points="126.5,511.9453,136.5,515.9453,126.5,519.9453,130.5,515.9453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="22.5" x2="132.5" y1="515.9453" y2="515.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="29.5" y="511.0889">stopRecording()</text><polygon fill="#A80036" points="371,542.2969,381,546.2969,371,550.2969,375,546.2969" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="138.5" x2="377" y1="546.2969" y2="546.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="145.5" y="541.4404">enque(stopRecording)</text><polygon fill="#A80036" points="404,572.6484,394,576.6484,404,580.6484,400,576.6484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="398" x2="752.5" y1="576.6484" y2="576.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="410" y="571.792">deque(stopRecording)</text><path d="M480,591.6484 L546,591.6484 L546,599.6484 L536,609.6484 L480,609.6484 L480,591.6484 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="109.4063" style="stroke:#000000;stroke-width:2.0;" width="528.5" x="480" y="591.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="495" y="606.1436">par</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="561" y="605.0674">[thread#2]</text><polygon fill="#A80036" points="567.5,628.3516,557.5,632.3516,567.5,636.3516,563.5,632.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="561.5" x2="752.5" y1="632.3516" y2="632.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="573.5" y="627.4951">dispatch(stopRecording)</text><polygon fill="#A80036" points="866,658.7031,876,662.7031,866,666.7031,870,662.7031" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="556.5" x2="872" y1="662.7031" y2="662.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="563.5" y="657.8467">closeStream()</text><polygon fill="#A80036" points="951,689.0547,961,693.0547,951,697.0547,955,693.0547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="556.5" x2="957" y1="693.0547" y2="693.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="563.5" y="688.1982">saveFile()</text><polygon fill="#A80036" points="399,726.4063,389,730.4063,399,734.4063,395,730.4063" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="393" x2="752.5" y1="730.4063" y2="730.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="405" y="725.5498">enque(notifyFileSaved{metadata})</text><polygon fill="#A80036" points="376,756.7578,386,760.7578,376,764.7578,380,760.7578" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="138.5" x2="382" y1="760.7578" y2="760.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="145.5" y="755.9014">deque(notifyFileSaved{metadata})</text><!--MD5=[a88e0371396e0259d18fcc937fce0ca9]
@startuml Message Queuing Implementation
title Message Queuing Implementation

actor "User" as usr

boundary "Tagging UI/iPad" as tag
box [serialized on the sender's \ndevice, but not visible to\nthe application after sending] 
    entity "Message Queue\n(ZMQ, RabbitMQ)" as mq
end box
control "Streaming/Encoding\nService" as strm
box [running in background]
    create "Dispatcher" as dsp
    strm -> dsp: start()
end box
collections "Cameras" as cams
usr -> tag: startRecording()
tag -> mq: enque(startRecording)
activate mq
dsp -> mq: deque(startRecording)

par thread#1
    dsp -> strm: dispatch(startRecording)
    deactivate mq
    strm -> cams: openStream()
    cams - -> strm: return(stream)
    create entity "Media File" as vid
    strm -> vid: encode()
    activate vid
end

usr -> tag: stopRecording()
tag -> mq: enque(stopRecording)
activate mq
dsp -> mq: deque(stopRecording)

par thread#2
    dsp -> strm: dispatch(stopRecording)
    deactivate mq
    strm -> cams: closeStream()
    strm -> vid: saveFile()
    deactivate vid
end

dsp -> mq: enque(notifyFileSaved{metadata})
tag -> mq: deque(notifyFileSaved{metadata})

@enduml

PlantUML version 1.2020.22(Sun Dec 06 15:06:27 IST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: IN
--></g></svg>