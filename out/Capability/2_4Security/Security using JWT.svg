<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="969px" preserveAspectRatio="none" style="width:1205px;height:969px;" version="1.1" viewBox="0 0 1205 969" width="1205px" zoomAndPan="magnify"><defs><filter height="300%" id="f15fg1ypmk5855" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="156" x="526.5" y="30.6855">Security using JWT</text><rect fill="#FFFFFF" filter="url(#f15fg1ypmk5855)" height="78.0547" style="stroke:#000000;stroke-width:2.0;" width="249" x="820.5" y="479.5391"/><rect fill="#FFFFFF" filter="url(#f15fg1ypmk5855)" height="125.2422" style="stroke:#000000;stroke-width:2.0;" width="693.5" x="10" y="739.7031"/><rect fill="#FFFFFF" height="46.1875" style="stroke:none;stroke-width:1.0;" width="693.5" x="10" y="818.7578"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="37" x2="37" y1="126.25" y2="881.9453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="243.5" x2="243.5" y1="126.25" y2="881.9453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="483.5" x2="483.5" y1="126.25" y2="881.9453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="636.5" x2="636.5" y1="126.25" y2="881.9453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="879.5" x2="879.5" y1="199.9063" y2="881.9453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1064" x2="1064" y1="292.1719" y2="881.9453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1163" x2="1163" y1="126.25" y2="881.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="20" y="123.1738">User</text><ellipse cx="37.5" cy="51.6406" fill="#FEFECE" filter="url(#f15fg1ypmk5855)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M37.5,59.6406 L37.5,86.6406 M24.5,67.6406 L50.5,67.6406 M37.5,86.6406 L24.5,101.6406 M37.5,86.6406 L50.5,101.6406 " fill="none" filter="url(#f15fg1ypmk5855)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="20" y="895.4785">User</text><ellipse cx="37.5" cy="908.5547" fill="#FEFECE" filter="url(#f15fg1ypmk5855)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M37.5,916.5547 L37.5,943.5547 M24.5,924.5547 L50.5,924.5547 M37.5,943.5547 L24.5,958.5547 M37.5,943.5547 L50.5,958.5547 " fill="none" filter="url(#f15fg1ypmk5855)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f15fg1ypmk5855)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="86" x="200.5" y="85.6406"/><rect fill="#FEFECE" filter="url(#f15fg1ypmk5855)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="86" x="196.5" y="89.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="203.5" y="111.1738">Consumers</text><rect fill="#FEFECE" filter="url(#f15fg1ypmk5855)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="86" x="200.5" y="880.9453"/><rect fill="#FEFECE" filter="url(#f15fg1ypmk5855)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="86" x="196.5" y="884.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="203.5" y="906.4785">Consumers</text><rect fill="#FEFECE" filter="url(#f15fg1ypmk5855)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="66" x="450.5" y="85.6406"/><rect fill="#FEFECE" filter="url(#f15fg1ypmk5855)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="66" x="446.5" y="89.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="453.5" y="111.1738">Sources</text><rect fill="#FEFECE" filter="url(#f15fg1ypmk5855)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="66" x="450.5" y="880.9453"/><rect fill="#FEFECE" filter="url(#f15fg1ypmk5855)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="66" x="446.5" y="884.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="453.5" y="906.4785">Sources</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="579.5" y="123.1738">Directory Service</text><ellipse cx="636.5" cy="92.6406" fill="#FEFECE" filter="url(#f15fg1ypmk5855)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="632.5,80.6406,638.5,75.6406,636.5,80.6406,638.5,85.6406,632.5,80.6406" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="579.5" y="895.4785">Directory Service</text><ellipse cx="636.5" cy="914.5547" fill="#FEFECE" filter="url(#f15fg1ypmk5855)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="632.5,902.5547,638.5,897.5547,636.5,902.5547,638.5,907.5547,632.5,902.5547" style="stroke:#A80036;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f15fg1ypmk5855)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="94" x="830.5" y="880.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="837.5" y="902.4785">JWT Factory</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="1030" y="895.4785">Dictionary</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="1017" y="913.0879">(jwt, requests)</text><ellipse cx="1064.5" cy="932.1641" fill="#FEFECE" filter="url(#f15fg1ypmk5855)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="1052.5" x2="1076.5" y1="946.1641" y2="946.1641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="1135.5" y="105.5645">Roles &amp;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="1122" y="123.1738">Permissions</text><path d="M1145,55.0313 C1145,45.0313 1163,45.0313 1163,45.0313 C1163,45.0313 1181,45.0313 1181,55.0313 L1181,81.0313 C1181,91.0313 1163,91.0313 1163,91.0313 C1163,91.0313 1145,91.0313 1145,81.0313 L1145,55.0313 " fill="#FEFECE" filter="url(#f15fg1ypmk5855)" style="stroke:#000000;stroke-width:1.5;"/><path d="M1145,55.0313 C1145,65.0313 1163,65.0313 1163,65.0313 C1163,65.0313 1181,65.0313 1181,55.0313 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="1135.5" y="895.4785">Roles &amp;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="1122" y="913.0879">Permissions</text><path d="M1145,926.1641 C1145,916.1641 1163,916.1641 1163,916.1641 C1163,916.1641 1181,916.1641 1181,926.1641 L1181,952.1641 C1181,962.1641 1163,962.1641 1163,962.1641 C1163,962.1641 1145,962.1641 1145,952.1641 L1145,926.1641 " fill="#FEFECE" filter="url(#f15fg1ypmk5855)" style="stroke:#000000;stroke-width:1.5;"/><path d="M1145,926.1641 C1145,936.1641 1163,936.1641 1163,936.1641 C1163,936.1641 1181,936.1641 1181,926.1641 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><polygon fill="#A80036" points="624.5,154.6016,634.5,158.6016,624.5,162.6016,628.5,158.6016" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="483.5" x2="630.5" y1="158.6016" y2="158.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="490.5" y="153.7451">register(credentials)</text><polygon fill="#A80036" points="818.5,184.9531,828.5,188.9531,818.5,192.9531,822.5,188.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="636.5" x2="824.5" y1="188.9531" y2="188.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="643.5" y="184.0967">init(signatureSecret, sources)</text><rect fill="#FEFECE" filter="url(#f15fg1ypmk5855)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="94" x="830.5" y="166.6016"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="837.5" y="188.1348">JWT Factory</text><polygon fill="#A80036" points="494.5,231.5625,484.5,235.5625,494.5,239.5625,490.5,235.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="488.5" x2="878.5" y1="235.5625" y2="235.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="500.5" y="230.7061">return(dictionary&lt;jwt, requests&gt;)</text><polygon fill="#A80036" points="1005,261.9141,1015,265.9141,1005,269.9141,1009,265.9141" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="483.5" x2="1011" y1="265.9141" y2="265.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="490.5" y="261.0576">create()</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="1030" y="290.0957">Dictionary</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="1017" y="307.7051">(jwt, requests)</text><ellipse cx="1064.5" cy="259.5625" fill="#FEFECE" filter="url(#f15fg1ypmk5855)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/><line style="stroke:#A80036;stroke-width:2.0;" x1="1052.5" x2="1076.5" y1="273.5625" y2="273.5625"/><polygon fill="#A80036" points="231.5,339.1328,241.5,343.1328,231.5,347.1328,235.5,343.1328" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="37.5" x2="237.5" y1="343.1328" y2="343.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="44.5" y="338.2764">openVideoThumbnail(metadata)</text><polygon fill="#A80036" points="624.5,369.4844,634.5,373.4844,624.5,377.4844,628.5,373.4844" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="243.5" x2="630.5" y1="373.4844" y2="373.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="250.5" y="368.6279">authenticate(credentials)</text><polygon fill="#A80036" points="1151,399.8359,1161,403.8359,1151,407.8359,1155,403.8359" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="636.5" x2="1157" y1="403.8359" y2="403.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="643.5" y="398.9795">fetchPermissions(credentials)</text><polygon fill="#A80036" points="647.5,430.1875,637.5,434.1875,647.5,438.1875,643.5,434.1875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="641.5" x2="1162" y1="434.1875" y2="434.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="653.5" y="429.3311">return(role)</text><polygon fill="#A80036" points="867.5,460.5391,877.5,464.5391,867.5,468.5391,871.5,464.5391" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="636.5" x2="873.5" y1="464.5391" y2="464.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="643.5" y="459.6826">createToken(role)</text><path d="M820.5,479.5391 L893.5,479.5391 L893.5,487.5391 L883.5,497.5391 L820.5,497.5391 L820.5,479.5391 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="78.0547" style="stroke:#000000;stroke-width:2.0;" width="249" x="820.5" y="479.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="835.5" y="494.0342">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="100" x="908.5" y="492.958">[for every Source]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="879.5" x2="921.5" y1="536.5938" y2="536.5938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="921.5" x2="921.5" y1="536.5938" y2="549.5938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="880.5" x2="921.5" y1="549.5938" y2="549.5938"/><polygon fill="#A80036" points="890.5,545.5938,880.5,549.5938,890.5,553.5938,886.5,549.5938" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="886.5" y="515.3857">create(encryptionMethod,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="886.5" y="531.7373">rolePayload, signatureSecret)</text><polygon fill="#A80036" points="647.5,582.9453,637.5,586.9453,647.5,590.9453,643.5,586.9453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="641.5" x2="878.5" y1="586.9453" y2="586.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="653.5" y="582.0889">return(jwtCollection)</text><polygon fill="#A80036" points="254.5,613.2969,244.5,617.2969,254.5,621.2969,250.5,617.2969" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="248.5" x2="635.5" y1="617.2969" y2="617.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="260.5" y="612.4404">return(jwtCollection)</text><polygon fill="#A80036" points="471.5,660,481.5,664,471.5,668,475.5,664" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="243.5" x2="477.5" y1="664" y2="664"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="250.5" y="642.792">fetchVideoRequest(jwtCollection[src],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="250.5" y="659.1436">metadata)</text><polygon fill="#A80036" points="1052.5,690.3516,1062.5,694.3516,1052.5,698.3516,1056.5,694.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="483.5" x2="1058.5" y1="694.3516" y2="694.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="490.5" y="689.4951">valdateRequest(jwt, fetchVideo)</text><polygon fill="#A80036" points="494.5,720.7031,484.5,724.7031,494.5,728.7031,490.5,724.7031" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="488.5" x2="1063.5" y1="724.7031" y2="724.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="500.5" y="719.8467">return(validation)</text><path d="M10,739.7031 L71,739.7031 L71,747.7031 L61,757.7031 L10,757.7031 L10,739.7031 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="125.2422" style="stroke:#000000;stroke-width:2.0;" width="693.5" x="10" y="739.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="25" y="754.1982">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="86" y="753.1221">[if request valdates]</text><polygon fill="#A80036" points="254.5,776.4063,244.5,780.4063,254.5,784.4063,250.5,780.4063" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="248.5" x2="482.5" y1="780.4063" y2="780.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="260.5" y="775.5498">return(videoStream)</text><polygon fill="#A80036" points="48.5,806.7578,38.5,810.7578,48.5,814.7578,44.5,810.7578" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="42.5" x2="242.5" y1="810.7578" y2="810.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="54.5" y="805.9014">showVideo()</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="703.5" y1="819.7578" y2="819.7578"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="122" x="15" y="831.1768">[if authentication fails]</text><polygon fill="#A80036" points="624.5,852.9453,634.5,856.9453,624.5,860.9453,628.5,856.9453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="483.5" x2="630.5" y1="856.9453" y2="856.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="490.5" y="852.0889">invalidRequest(details)</text><!--MD5=[a88b06cf8bdaa334b79bc49fd35456da]
@startuml Security using JWT
title Security using JWT
actor "User" as user
collections "Consumers" as cons
collections "Sources" as srcs
control "Directory Service" as dir
srcs -> dir: register(credentials)

create "JWT Factory" as jwt
dir -> jwt: init(signatureSecret, sources)
jwt - -> srcs: return(dictionary<jwt, requests>)
create entity "Dictionary\n(jwt, requests)" as dict
srcs -> dict: create()
database "Roles &\nPermissions" as db
user -> cons: openVideoThumbnail(metadata)
cons -> dir: authenticate(credentials)
dir -> db: fetchPermissions(credentials)
db - -> dir: return(role)
dir -> jwt: createToken(role)
loop for every Source
    jwt -> jwt: create(encryptionMethod,\nrolePayload, signatureSecret)
end
jwt - -> dir: return(jwtCollection)
dir - -> cons: return(jwtCollection)
cons -> srcs: fetchVideoRequest(jwtCollection[src],\nmetadata)
srcs -> dict: valdateRequest(jwt, fetchVideo)
dict - -> srcs: return(validation)
alt if request valdates
    srcs - -> cons: return(videoStream)
    cons - -> user: showVideo()
else if authentication fails
    srcs -> dir: invalidRequest(details)
end

@enduml

PlantUML version 1.2020.22(Sun Dec 06 15:06:27 IST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: IN
--></g></svg>